<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Multi-agent path finding: Environment Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Multi-agent path finding
   </div>
   <div id="projectbrief">Environment of a multi-agent path finding system, and solution using RL algorithms (see: https://github.com/redvinaa/multi-agent-path-finding-continuous)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classEnvironment-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Environment Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classEnvironment.html" title="Environment for multi-agent path finding simulation.">Environment</a> for multi-agent path finding simulation.  
 <a href="classEnvironment.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="environment__core_8h_source.html">environment_core.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a626c47eb76814e2160b26008081ff290"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEnvironment.html#a626c47eb76814e2160b26008081ff290">Environment</a> (std::string _map_path, float _physics_step_size=0.01, float _laser_max_angle=45.*M_PI/180., float _laser_max_dist=10., float _robot_diam=0.8, int _velocity_iterations=6, int _position_iterations=2, int _render_height=700, int _laser_nrays=10, bool _draw_laser=false, float _goal_reaching_reward=0., float _collision_reward=-1., float _step_reward=-1.)</td></tr>
<tr class="memdesc:a626c47eb76814e2160b26008081ff290"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the default parameters, and calls <a class="el" href="classEnvironment.html#ae4ce7d9e59dbc44f87015461453f49b3" title="Load map.">init_map()</a> and <a class="el" href="classEnvironment.html#a9e00bd32644e4c37d731f04bcd0940f4" title="Create box2d physics world, create boundaries and add obstacles based on the map image.">init_physics()</a>  <a href="classEnvironment.html#a626c47eb76814e2160b26008081ff290">More...</a><br /></td></tr>
<tr class="separator:a626c47eb76814e2160b26008081ff290"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4ce7d9e59dbc44f87015461453f49b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEnvironment.html#ae4ce7d9e59dbc44f87015461453f49b3">init_map</a> (void)</td></tr>
<tr class="memdesc:ae4ce7d9e59dbc44f87015461453f49b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load map.  <a href="classEnvironment.html#ae4ce7d9e59dbc44f87015461453f49b3">More...</a><br /></td></tr>
<tr class="separator:ae4ce7d9e59dbc44f87015461453f49b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e00bd32644e4c37d731f04bcd0940f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEnvironment.html#a9e00bd32644e4c37d731f04bcd0940f4">init_physics</a> (void)</td></tr>
<tr class="memdesc:a9e00bd32644e4c37d731f04bcd0940f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create box2d physics world, create boundaries and add obstacles based on the map image.  <a href="classEnvironment.html#a9e00bd32644e4c37d731f04bcd0940f4">More...</a><br /></td></tr>
<tr class="separator:a9e00bd32644e4c37d731f04bcd0940f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a4fbabaf68d5553299592c569ed5c18"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEnvironment.html#a0a4fbabaf68d5553299592c569ed5c18">generate_empty_index</a> (void)</td></tr>
<tr class="memdesc:a0a4fbabaf68d5553299592c569ed5c18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Randomly find an empty place on the map (no obstacles and no other agents nearby)  <a href="classEnvironment.html#a0a4fbabaf68d5553299592c569ed5c18">More...</a><br /></td></tr>
<tr class="separator:a0a4fbabaf68d5553299592c569ed5c18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bf96c5e6b817be1595b24992cde8e82"><td class="memItemLeft" align="right" valign="top"><a id="a9bf96c5e6b817be1595b24992cde8e82"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEnvironment.html#a9bf96c5e6b817be1595b24992cde8e82">reset</a> ()</td></tr>
<tr class="memdesc:a9bf96c5e6b817be1595b24992cde8e82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set done=false, and generate new goals for all the current agents. <br /></td></tr>
<tr class="separator:a9bf96c5e6b817be1595b24992cde8e82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a39f789194778e73ad0e1ef2433f7ac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEnvironment.html#a1a39f789194778e73ad0e1ef2433f7ac">add_agent</a> ()</td></tr>
<tr class="memdesc:a1a39f789194778e73ad0e1ef2433f7ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an agent with physics, random starting and goal positions.  <a href="classEnvironment.html#a1a39f789194778e73ad0e1ef2433f7ac">More...</a><br /></td></tr>
<tr class="separator:a1a39f789194778e73ad0e1ef2433f7ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4779c221230d53f9ac91c3b631df5ce2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEnvironment.html#a4779c221230d53f9ac91c3b631df5ce2">remove_agent</a> (int agent_index)</td></tr>
<tr class="memdesc:a4779c221230d53f9ac91c3b631df5ce2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove the given agent and its goal from the simulation.  <a href="classEnvironment.html#a4779c221230d53f9ac91c3b631df5ce2">More...</a><br /></td></tr>
<tr class="separator:a4779c221230d53f9ac91c3b631df5ce2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac22c7d2a724fb28e4b71d6723475e6e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEnvironment.html#ac22c7d2a724fb28e4b71d6723475e6e7">step_physics</a> ()</td></tr>
<tr class="memdesc:ac22c7d2a724fb28e4b71d6723475e6e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove the given agent and its goal from the simulation.  <a href="classEnvironment.html#ac22c7d2a724fb28e4b71d6723475e6e7">More...</a><br /></td></tr>
<tr class="separator:ac22c7d2a724fb28e4b71d6723475e6e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e098b4273d7dc8f9bf70e7b578a0e3d"><td class="memItemLeft" align="right" valign="top">cv::Mat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEnvironment.html#a0e098b4273d7dc8f9bf70e7b578a0e3d">render</a> ()</td></tr>
<tr class="memdesc:a0e098b4273d7dc8f9bf70e7b578a0e3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Render the obstacles, agents, goals, optionally the raycasts, and show collisions as well.  <a href="classEnvironment.html#a0e098b4273d7dc8f9bf70e7b578a0e3d">More...</a><br /></td></tr>
<tr class="separator:a0e098b4273d7dc8f9bf70e7b578a0e3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84bea5f6023a135b869f338e53191e32"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEnvironment.html#a84bea5f6023a135b869f338e53191e32">process_action</a> (int agent_index, geometry_msgs::Twist action)</td></tr>
<tr class="memdesc:a84bea5f6023a135b869f338e53191e32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save the linear and angular velocity of the given agent.  <a href="classEnvironment.html#a84bea5f6023a135b869f338e53191e32">More...</a><br /></td></tr>
<tr class="separator:a84bea5f6023a135b869f338e53191e32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8e805ad3a976724265eaff69400e32a"><td class="memItemLeft" align="right" valign="top">mapf_environment::Observation&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classEnvironment.html#ab8e805ad3a976724265eaff69400e32a">get_observation</a> (int agent_index)</td></tr>
<tr class="memdesc:ab8e805ad3a976724265eaff69400e32a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the observations for the given agent.  <a href="classEnvironment.html#ab8e805ad3a976724265eaff69400e32a">More...</a><br /></td></tr>
<tr class="separator:ab8e805ad3a976724265eaff69400e32a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ac125317ce75c5a14214a5ea309316df7"><td class="memItemLeft" align="right" valign="top"><a id="ac125317ce75c5a14214a5ea309316df7"></a>
b2Vec2&#160;</td><td class="memItemRight" valign="bottom"><b>gravity</b></td></tr>
<tr class="separator:ac125317ce75c5a14214a5ea309316df7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80460b42c58dfd40e863f1c5522c5cb4"><td class="memItemLeft" align="right" valign="top"><a id="a80460b42c58dfd40e863f1c5522c5cb4"></a>
b2World&#160;</td><td class="memItemRight" valign="bottom"><b>world</b></td></tr>
<tr class="separator:a80460b42c58dfd40e863f1c5522c5cb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bc6615c6ac6b5e89565aa78d8bce74c"><td class="memItemLeft" align="right" valign="top"><a id="a6bc6615c6ac6b5e89565aa78d8bce74c"></a>
std::vector&lt; b2Body * &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>agent_bodies</b></td></tr>
<tr class="separator:a6bc6615c6ac6b5e89565aa78d8bce74c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11fc589391361dd973467e019a204f3a"><td class="memItemLeft" align="right" valign="top"><a id="a11fc589391361dd973467e019a204f3a"></a>
std::vector&lt; b2Body * &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>obstacle_bodies</b></td></tr>
<tr class="separator:a11fc589391361dd973467e019a204f3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfa1b7b91f70d1db85c139427498635d"><td class="memItemLeft" align="right" valign="top"><a id="adfa1b7b91f70d1db85c139427498635d"></a>
std::vector&lt; b2Vec2 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>goal_positions</b></td></tr>
<tr class="separator:adfa1b7b91f70d1db85c139427498635d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c65136b6ce58a82d496d9f33c48ab95"><td class="memItemLeft" align="right" valign="top"><a id="a0c65136b6ce58a82d496d9f33c48ab95"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>physics_step_size</b></td></tr>
<tr class="separator:a0c65136b6ce58a82d496d9f33c48ab95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d6e91e72bc57dfff48ce04d504db1ed"><td class="memItemLeft" align="right" valign="top"><a id="a6d6e91e72bc57dfff48ce04d504db1ed"></a>
int32&#160;</td><td class="memItemRight" valign="bottom"><b>velocity_iterations</b></td></tr>
<tr class="separator:a6d6e91e72bc57dfff48ce04d504db1ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42f49229837cb99a0dd833bd85a44c62"><td class="memItemLeft" align="right" valign="top"><a id="a42f49229837cb99a0dd833bd85a44c62"></a>
int32&#160;</td><td class="memItemRight" valign="bottom"><b>position_iterations</b></td></tr>
<tr class="separator:a42f49229837cb99a0dd833bd85a44c62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad028052447206bf2130c965ca159ee08"><td class="memItemLeft" align="right" valign="top"><a id="ad028052447206bf2130c965ca159ee08"></a>
std::vector&lt; cv::Scalar &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>agent_colors</b></td></tr>
<tr class="separator:ad028052447206bf2130c965ca159ee08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d3b82f0fb46da16671ddb8f0385b74f"><td class="memItemLeft" align="right" valign="top"><a id="a9d3b82f0fb46da16671ddb8f0385b74f"></a>
std::vector&lt; float &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>agent_lin_vel</b></td></tr>
<tr class="separator:a9d3b82f0fb46da16671ddb8f0385b74f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08ac24b8d82ceb74b27d0435aaf51d84"><td class="memItemLeft" align="right" valign="top"><a id="a08ac24b8d82ceb74b27d0435aaf51d84"></a>
std::vector&lt; float &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>agent_ang_vel</b></td></tr>
<tr class="separator:a08ac24b8d82ceb74b27d0435aaf51d84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b9d35172b0afac612f65b68049bfa9f"><td class="memItemLeft" align="right" valign="top"><a id="a0b9d35172b0afac612f65b68049bfa9f"></a>
std::vector&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>collisions</b></td></tr>
<tr class="separator:a0b9d35172b0afac612f65b68049bfa9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2964dc178b985d9c3f10fe8bcf8e6653"><td class="memItemLeft" align="right" valign="top"><a id="a2964dc178b985d9c3f10fe8bcf8e6653"></a>
std::vector&lt; sensor_msgs::LaserScan &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>laser_scans</b></td></tr>
<tr class="separator:a2964dc178b985d9c3f10fe8bcf8e6653"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3846a39039a5f42c71263cc6d6b8a46"><td class="memItemLeft" align="right" valign="top"><a id="ad3846a39039a5f42c71263cc6d6b8a46"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>draw_laser</b></td></tr>
<tr class="separator:ad3846a39039a5f42c71263cc6d6b8a46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a91472adf2e545d121e4a2772e7cdc6"><td class="memItemLeft" align="right" valign="top"><a id="a1a91472adf2e545d121e4a2772e7cdc6"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>block_size</b></td></tr>
<tr class="separator:a1a91472adf2e545d121e4a2772e7cdc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf4731271806e8e82928f8372eeffe01"><td class="memItemLeft" align="right" valign="top"><a id="acf4731271806e8e82928f8372eeffe01"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>scale_factor</b></td></tr>
<tr class="separator:acf4731271806e8e82928f8372eeffe01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a040e4b938a2ca89a9b05c601e527eda8"><td class="memItemLeft" align="right" valign="top"><a id="a040e4b938a2ca89a9b05c601e527eda8"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>laser_max_angle</b></td></tr>
<tr class="separator:a040e4b938a2ca89a9b05c601e527eda8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa204680795a17bbad3e7703c494cc076"><td class="memItemLeft" align="right" valign="top"><a id="aa204680795a17bbad3e7703c494cc076"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>laser_max_dist</b></td></tr>
<tr class="separator:aa204680795a17bbad3e7703c494cc076"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bce91fee0e7c9a943f06ef91bd68874"><td class="memItemLeft" align="right" valign="top"><a id="a5bce91fee0e7c9a943f06ef91bd68874"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>robot_diam</b></td></tr>
<tr class="separator:a5bce91fee0e7c9a943f06ef91bd68874"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa63229747a1982be93c1663a9c61f6b7"><td class="memItemLeft" align="right" valign="top"><a id="aa63229747a1982be93c1663a9c61f6b7"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>robot_radius</b></td></tr>
<tr class="separator:aa63229747a1982be93c1663a9c61f6b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a031cbd094ec9cd3be1057870d327e298"><td class="memItemLeft" align="right" valign="top"><a id="a031cbd094ec9cd3be1057870d327e298"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>map_width</b></td></tr>
<tr class="separator:a031cbd094ec9cd3be1057870d327e298"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fb3460c685dce8951f875d046c805de"><td class="memItemLeft" align="right" valign="top"><a id="a4fb3460c685dce8951f875d046c805de"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>map_height</b></td></tr>
<tr class="separator:a4fb3460c685dce8951f875d046c805de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a756247b802f59edf5dffc2ff97aa40fa"><td class="memItemLeft" align="right" valign="top"><a id="a756247b802f59edf5dffc2ff97aa40fa"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>goal_reaching_reward</b></td></tr>
<tr class="separator:a756247b802f59edf5dffc2ff97aa40fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97d3aa7ed7a85db2d1bc5b0520e33ace"><td class="memItemLeft" align="right" valign="top"><a id="a97d3aa7ed7a85db2d1bc5b0520e33ace"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>collision_reward</b></td></tr>
<tr class="separator:a97d3aa7ed7a85db2d1bc5b0520e33ace"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3da0b9cbf7dcb249d90004c2284fbff4"><td class="memItemLeft" align="right" valign="top"><a id="a3da0b9cbf7dcb249d90004c2284fbff4"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>step_reward</b></td></tr>
<tr class="separator:a3da0b9cbf7dcb249d90004c2284fbff4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af67562df9c4eaac30e4d9b943b6ebf26"><td class="memItemLeft" align="right" valign="top"><a id="af67562df9c4eaac30e4d9b943b6ebf26"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>map_path</b></td></tr>
<tr class="separator:af67562df9c4eaac30e4d9b943b6ebf26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6168e6f2d66b97a4b3690c19119f8ed"><td class="memItemLeft" align="right" valign="top"><a id="aa6168e6f2d66b97a4b3690c19119f8ed"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>render_height</b></td></tr>
<tr class="separator:aa6168e6f2d66b97a4b3690c19119f8ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f5ca753014297d8a1517ddccb3ec0c2"><td class="memItemLeft" align="right" valign="top"><a id="a9f5ca753014297d8a1517ddccb3ec0c2"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>laser_nrays</b></td></tr>
<tr class="separator:a9f5ca753014297d8a1517ddccb3ec0c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0afb8fb50b04214a93b2aad127ccf68"><td class="memItemLeft" align="right" valign="top"><a id="ae0afb8fb50b04214a93b2aad127ccf68"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>number_of_agents</b></td></tr>
<tr class="separator:ae0afb8fb50b04214a93b2aad127ccf68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10c9ffda2061f72b25bf57471a7f0eca"><td class="memItemLeft" align="right" valign="top"><a id="a10c9ffda2061f72b25bf57471a7f0eca"></a>
cv::Mat&#160;</td><td class="memItemRight" valign="bottom"><b>map_image_raw</b></td></tr>
<tr class="separator:a10c9ffda2061f72b25bf57471a7f0eca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af12fd7cd085a3f4619db87f0d6b1d11d"><td class="memItemLeft" align="right" valign="top"><a id="af12fd7cd085a3f4619db87f0d6b1d11d"></a>
cv::Mat&#160;</td><td class="memItemRight" valign="bottom"><b>map_image</b></td></tr>
<tr class="separator:af12fd7cd085a3f4619db87f0d6b1d11d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c255b78a240762751bfed73b7abf1c4"><td class="memItemLeft" align="right" valign="top"><a id="a4c255b78a240762751bfed73b7abf1c4"></a>
cv::Mat&#160;</td><td class="memItemRight" valign="bottom"><b>rendered_image</b></td></tr>
<tr class="separator:a4c255b78a240762751bfed73b7abf1c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3ed006c1b56dc51b0e7aeca93d7993d"><td class="memItemLeft" align="right" valign="top"><a id="ad3ed006c1b56dc51b0e7aeca93d7993d"></a>
cv::Scalar&#160;</td><td class="memItemRight" valign="bottom"><b>color</b></td></tr>
<tr class="separator:ad3ed006c1b56dc51b0e7aeca93d7993d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2051c6520814e379b4718634e4d435c7"><td class="memItemLeft" align="right" valign="top"><a id="a2051c6520814e379b4718634e4d435c7"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>done</b></td></tr>
<tr class="separator:a2051c6520814e379b4718634e4d435c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classEnvironment.html" title="Environment for multi-agent path finding simulation.">Environment</a> for multi-agent path finding simulation. </p>
<p>This is the core (without ROS) class, that includes the physics and visualization. Multiple agents can be added, and any map can be used. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a626c47eb76814e2160b26008081ff290"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a626c47eb76814e2160b26008081ff290">&#9670;&nbsp;</a></span>Environment()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Environment::Environment </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>_map_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>_physics_step_size</em> = <code>0.01</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>_laser_max_angle</em> = <code>45.*M_PI/180.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>_laser_max_dist</em> = <code>10.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>_robot_diam</em> = <code>0.8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_velocity_iterations</em> = <code>6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_position_iterations</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_render_height</em> = <code>700</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>_laser_nrays</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>_draw_laser</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>_goal_reaching_reward</em> = <code>0.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>_collision_reward</em> = <code>-1.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>_step_reward</em> = <code>-1.</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the default parameters, and calls <a class="el" href="classEnvironment.html#ae4ce7d9e59dbc44f87015461453f49b3" title="Load map.">init_map()</a> and <a class="el" href="classEnvironment.html#a9e00bd32644e4c37d731f04bcd0940f4" title="Create box2d physics world, create boundaries and add obstacles based on the map image.">init_physics()</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_map_path</td><td>Map image to load </td></tr>
    <tr><td class="paramname">_physics_step_size</td><td>Time delta for the physics engine </td></tr>
    <tr><td class="paramname">_laser_max_angle</td><td>The angle of the laser raycast from the centerline </td></tr>
    <tr><td class="paramname">_laser_max_dist</td><td>Maximum distance for the raycast </td></tr>
    <tr><td class="paramname">_robot_diam</td><td>Diameter of the simulated robots (one pixel on the map is 1 meter) </td></tr>
    <tr><td class="paramname">_velocity_iterations</td><td>Parameter of the box2d physics engine </td></tr>
    <tr><td class="paramname">_position_iterations</td><td>Parameter of the box2d physics engine </td></tr>
    <tr><td class="paramname">_render_height</td><td>Height of the rendered image (from which the width is given) </td></tr>
    <tr><td class="paramname">_laser_nrays</td><td>Number of rays for the raycast </td></tr>
    <tr><td class="paramname">_draw_laser</td><td>Wether to show the raycasts on the rendered image </td></tr>
    <tr><td class="paramname">_goal_reaching_reward</td><td>Reward for reaching the goal (only if all the other agents reach their goal too) </td></tr>
    <tr><td class="paramname">_collision_reward</td><td>Added reward in the case of a collision </td></tr>
    <tr><td class="paramname">_step_reward</td><td>Reward added in every step, except when the goal is reached </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classEnvironment.html#ae4ce7d9e59dbc44f87015461453f49b3" title="Load map.">init_map()</a>, <a class="el" href="classEnvironment.html#a9e00bd32644e4c37d731f04bcd0940f4" title="Create box2d physics world, create boundaries and add obstacles based on the map image.">init_physics()</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a1a39f789194778e73ad0e1ef2433f7ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a39f789194778e73ad0e1ef2433f7ac">&#9670;&nbsp;</a></span>add_agent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Environment::add_agent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create an agent with physics, random starting and goal positions. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classEnvironment.html#a0a4fbabaf68d5553299592c569ed5c18" title="Randomly find an empty place on the map (no obstacles and no other agents nearby)">generate_empty_index()</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Index of the new agent (starting from 0) </dd></dl>

</div>
</div>
<a id="a0a4fbabaf68d5553299592c569ed5c18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a4fbabaf68d5553299592c569ed5c18">&#9670;&nbsp;</a></span>generate_empty_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Environment::generate_empty_index </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Randomly find an empty place on the map (no obstacles and no other agents nearby) </p>
<dl class="section return"><dt>Returns</dt><dd>The flattened (row*image_width + col) index of the cell that is found to be free. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>Raised if no free cells are found </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab8e805ad3a976724265eaff69400e32a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8e805ad3a976724265eaff69400e32a">&#9670;&nbsp;</a></span>get_observation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mapf_environment::Observation Environment::get_observation </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>agent_index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the observations for the given agent. </p>
<p>The observations are the following:</p><ul>
<li>sensor_msgs/LaserScan scan</li>
<li>geometry_msgs/Point agent_pose # linear x, y, and angle z</li>
<li>geometry_msgs/Point agent_twist # linear x, and angle z</li>
<li>geometry_msgs/Point goal_pose # x, y only</li>
<li>float32 reward</li>
<li>bool done</li>
</ul>
<p>After the observation for the given agent is queried, the collision for that agent is set to false, so it is important that this function is called at most once per physics step. Also, the collisions are only set false here, but not in <a class="el" href="classEnvironment.html#ac22c7d2a724fb28e4b71d6723475e6e7" title="Remove the given agent and its goal from the simulation.">step_physics()</a></p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classEnvironment.html#ac22c7d2a724fb28e4b71d6723475e6e7" title="Remove the given agent and its goal from the simulation.">step_physics()</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>The calculated observation </dd></dl>

</div>
</div>
<a id="ae4ce7d9e59dbc44f87015461453f49b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4ce7d9e59dbc44f87015461453f49b3">&#9670;&nbsp;</a></span>init_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Environment::init_map </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load map. </p>
<p>Load image at path _map_path. Image coordinates use the OpenCV convention. </p>

</div>
</div>
<a id="a9e00bd32644e4c37d731f04bcd0940f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e00bd32644e4c37d731f04bcd0940f4">&#9670;&nbsp;</a></span>init_physics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Environment::init_physics </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create box2d physics world, create boundaries and add obstacles based on the map image. </p>
<p>Physics coorinates use the Box2d convention. </p>

</div>
</div>
<a id="a84bea5f6023a135b869f338e53191e32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84bea5f6023a135b869f338e53191e32">&#9670;&nbsp;</a></span>process_action()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Environment::process_action </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>agent_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">geometry_msgs::Twist&#160;</td>
          <td class="paramname"><em>action</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save the linear and angular velocity of the given agent. </p>
<p>However, the velocities are set only in the <a class="el" href="classEnvironment.html#ac22c7d2a724fb28e4b71d6723475e6e7" title="Remove the given agent and its goal from the simulation.">step_physics()</a> </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="classEnvironment.html#ac22c7d2a724fb28e4b71d6723475e6e7" title="Remove the given agent and its goal from the simulation.">step_physics()</a> </dd></dl>

</div>
</div>
<a id="a4779c221230d53f9ac91c3b631df5ce2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4779c221230d53f9ac91c3b631df5ce2">&#9670;&nbsp;</a></span>remove_agent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Environment::remove_agent </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>agent_index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove the given agent and its goal from the simulation. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classEnvironment.html#a0a4fbabaf68d5553299592c569ed5c18" title="Randomly find an empty place on the map (no obstacles and no other agents nearby)">generate_empty_index()</a> </dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Index of the new agent (starting from 0) </dd></dl>

</div>
</div>
<a id="a0e098b4273d7dc8f9bf70e7b578a0e3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e098b4273d7dc8f9bf70e7b578a0e3d">&#9670;&nbsp;</a></span>render()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cv::Mat Environment::render </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Render the obstacles, agents, goals, optionally the raycasts, and show collisions as well. </p>
<dl class="section return"><dt>Returns</dt><dd>The rendered image </dd></dl>

</div>
</div>
<a id="ac22c7d2a724fb28e4b71d6723475e6e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac22c7d2a724fb28e4b71d6723475e6e7">&#9670;&nbsp;</a></span>step_physics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Environment::step_physics </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove the given agent and its goal from the simulation. </p>
<p>First the internally stored linear and angular velocities are set. Then, the physics simulation step is calculated. Finally, the observations are updated:</p><ul>
<li>laser_scans</li>
<li>collisions</li>
</ul>
<p>After that, the environment checks if all the agents reached their goals. If yes, then done=true is set. However, collisions are not set to false here, so as not to miss any. It is set to false after an observation is queried for the agent. </p><dl class="section return"><dt>Returns</dt><dd>Index of the new agent (starting from 0) </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>Raised if done=true </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classEnvironment.html#ab8e805ad3a976724265eaff69400e32a" title="Calculate the observations for the given agent.">get_observation()</a> </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>mapf_environment/include/mapf_environment/<a class="el" href="environment__core_8h_source.html">environment_core.h</a></li>
<li>mapf_environment/src/environment_core.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
